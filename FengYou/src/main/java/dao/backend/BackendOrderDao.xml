<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="dao.backend.BackendOrderDao">

	<!-- 每个酒店订单数量之比 -->
	<select id="getlistHotelUtil" resultType="util.HotelUtil" >
		SELECT h.hotelName name,COUNT(o.id) count from `order` o LEFT JOIN
		hotel h on(h.hotelId=o.hotelId ) GROUP BY h.hotelId

	</select>
	<!-- 首先通过酒店查询，根据预定月份分组，查询月份和每个月每个酒店订单数量 -->
	<select id="getlistByidDate" resultType="Chart" parameterType="int">
		SELECT (month(o.presetItme)-1) month ,COUNT(o.id) orderCount,o.hotelId
		hotelId FROM `order` o LEFT JOIN hotel h on(h.hotelId=o.hotelId )
		where o.hotelId=#{hotelId} GROUP BY month(o.presetItme)
	</select>

	<!-- 查询所有订单量 -->
	<select id="getlist" resultType="Order">
		SELECT * FROM `order`
	</select>

	<!-- 三表联查，酒店、房型和订单 -->
	<select id="query" resultType="Order">
		SELECT *,b.hotelName as
		hotelnames,c.houseType as houseTypes FROM `order` a
		,hotel b,house c
		WHERE a.hotelId=b.hotelId and a.houseId=c.houseId
	</select>

	<!--在入住和退房时间内查询 -->
	<select id="queryByx" resultType="Order">
		SELECT *,b.hotelName as
		hotelnames,c.houseType as houseTypes FROM `order` a
		,hotel b,house c
		WHERE a.hotelId=b.hotelId and a.houseId=c.houseId AND
		date_format(checkInDate,'%Y-%m-%d') between #{checkInDate} and
		#{checkOutDate}
	</select>

	<!-- 通过入住和退房时间内的之内时间和模糊查询订单号来查询 -->
	<select id="queryByx2" resultType="Order">
		SELECT *,b.hotelName as
		hotelnames,c.houseType as houseTypes FROM `order` a
		,hotel b,house c
		WHERE a.hotelId=b.hotelId and a.houseId=c.houseId AND
		date_format(checkInDate,'%Y-%m-%d') between #{checkInDate} and
		#{checkOutDate} and a.orderNo LIKE '%${sum}%'
	</select>

	<!-- 通过入住和退房时间内的之内时间和模糊查询酒店名称来查询 -->
	<select id="queryByx3" resultType="Order">
		SELECT *,b.hotelName as
		hotelnames,c.houseType as houseTypes FROM `order` a
		,hotel b,house c
		WHERE a.hotelId=b.hotelId and a.houseId=c.houseId AND
		date_format(checkInDate,'%Y-%m-%d') between #{checkInDate} and
		#{checkOutDate} and b.hotelName LIKE '%${sum}%'
	</select>

	<!-- 通过模糊查询酒店名称来查询 -->
	<select id="queryByx4" resultType="Order">
		SELECT *,b.hotelName as
		hotelnames,c.houseType as houseTypes FROM `order` a
		,hotel b,house c
		WHERE a.hotelId=b.hotelId and a.houseId=c.houseId and
		b.hotelName LIKE
		'%${sum}%'
	</select>

	<!-- 通过模糊查询订单号来查询 -->
	<select id="queryByx5" resultType="Order">
		SELECT *,b.hotelName as
		hotelnames,c.houseType as houseTypes FROM `order` a
		,hotel b,house c
		WHERE a.hotelId=b.hotelId and a.houseId=c.houseId and
		a.orderNo LIKE
		'%${sum}%'
	</select>

	<!-- 根据订单id删除订单 -->
	<delete id="deleteByid"> DELETE FROM `order` WHERE (`id`=#{id}) </delete>

</mapper>