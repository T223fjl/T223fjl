<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="dao.order.OrderDao">
	
	
	<select id="queryOrderById" parameterType="int" resultType="Order">
		select * from `test`.`order` where id=#{id}
	</select>
	
	<update id="updOrder"  parameterType="Order">
		UPDATE `test`.`order` SET    `orderStatus`=#{orderStatus}  
		<if test="remarks!=null and remarks!='' and remarks!=0" >
		, `remarks`=#{remarks}
		</if>
		 WHERE (`id`=#{id});
	</update>
	
	<select id="queryOrderByDate" resultType="Order" parameterType="Order">
				<![CDATA[
				SELECT * FROM  `order` o 
				where o.houseId=#{houseId} and  
				((o.checkInDate>=#{checkInDate} and o.checkInDate<=#{checkOutDate}) or
				(o.checkOutDate<=#{checkOutDate} and o.checkOutDate>=#{checkInDate})  )
		]]>
	</select>
	
	
	<select id="getOrderNew" resultType="Order">
	select * from `order` order by id desc limit 1 
	</select>
	
	<select id="getIntoNew" resultType="Intoinfo" >
	select * from `Intoinfo` order by id desc limit 1 
	</select>
	
	<insert id="addIntoinfo" parameterType="Intoinfo">
	INSERT INTO `test`.`intoinfo` (`userNames`, `phone`, `email`) VALUES ( #{userNames}, #{phone}, #{email});
	</insert>
	
	<select id="queryOrderByHouseId" resultType="House">
	select * from `order`
		where houseId=#{houseId}
	</select>

 	<insert id="addOrder" parameterType="Order" > 
	INSERT INTO `test`.`order` ( `orderNo`, `hotelId`, `houseId`, `houseCount`, `checkInDate`, `checkOutDate`, `orderStatus`, `payAmount`, `payType`, `place`, `userId`, `intoInfoId`, `remarks`) VALUES 
	( #{orderNo}, #{hotelId}, #{houseId}, #{houseCount}, 
	#{checkInDate}, #{checkOutDate}, #{orderStatus}, #{payAmount},
	 #{payType}, #{place}, #{userId}, #{intoInfoId}, #{remarks});
	</insert> 
</mapper>